<form id="addRuleForm" class="form-horizontal form-ajax" role="form" data-toggle="validator" method="POST" action="">
    {:token()}
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Ismenu')}:</label>
        <div class="col-xs-12 col-sm-8">
            {:build_radios('row[ismenu]', ['1'=>__('Yes'), '0'=>__('No')])}
        </div>
    </div>
    <div class="form-group">
        <label  class="control-label col-xs-12 col-sm-2">{:__('Parent')}:</label>
        <div class="col-xs-12 col-sm-8">
            {:build_select('row[pid]', $ruledata, null, ['class'=>'form-control', 'required'=>''])}
        </div>
    </div>
    <div class="form-group">
        <label for="name" class="control-label col-xs-12 col-sm-2">{:__('Name')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input type="text" class="form-control" id="name" name="row[name]" data-placeholder-node="{:__('Node tips')}" data-placeholder-menu="{:__('Menu tips')}" value="" data-rule="required" />
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Title')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input type="text" class="form-control" id="title" name="row[title]" value="" data-rule="required" />
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Icon')}:</label>
        <div class="col-xs-12 col-sm-8">
            <div class="input-group input-groupp-md">
                <span class="btnShowIcon input-group-addon"><i class="fa fa-genderless" style="font-size:16px;"></i></span>
                <input type="text" class="form-control inputIcon" name="row[icon]" value="fa fa-genderless" />
                <a href="javascript:;" class="btn-search-icon input-group-addon">{:__('Search icon')}</a>
            </div>
        </div>
    </div>
    <div class="form-group">
        <label for="weigh" class="control-label col-xs-12 col-sm-2">{:__('Weigh')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input type="text" class="form-control" id="weigh" name="row[weigh]" value="0" data-rule="required" />
        </div>
    </div>
    <div class="form-group">
        <label for="remark" class="control-label col-xs-12 col-sm-2">{:__('Condition')}:</label>
        <div class="col-xs-12 col-sm-8">
            <textarea class="form-control" id="condition" name="row[condition]"></textarea>
        </div>
    </div>
    <div class="form-group">
        <label for="remark" class="control-label col-xs-12 col-sm-2">{:__('Remark')}:</label>
        <div class="col-xs-12 col-sm-8">
            <textarea class="form-control" id="remark" name="row[remark]"></textarea>
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Status')}:</label>
        <div class="col-xs-12 col-sm-8">
            {:build_radios('row[status]', ['normal'=>__('Normal'), 'hidden'=>__('Hidden')])}
        </div>
    </div>
    <div class="form-group ">
        <div class="col-xs-2"></div>
        <div class="col-xs-12 col-sm-8">
            <button type="submit" class="btn btn-success btn-embossed">{:__('OK')}</button>
        </div>
    </div>
</form>


<script>
    require(['jquery', 'lrBox', 'lrEle'], function ($, lrBox, lrEle) {
        var saveUrl = '/auth/rule/add/';
        var iconsUrl = '/auth/rule/allIcon/';
        var form = $('#addRuleForm');
        form.find('.btn-search-icon').click(function () {
            lrBox.msgView('Icons', '[url]'+  iconsUrl, 1000, 0)
        });
        form.find('.inputIcon').on('keyup', function () {
            var input_ = $(this);
            form.find('.btnShowIcon i').attr('class', input_.val());
        });
        window.pushFontIcon = function(fontClass) {
            fontClass = 'fa fa-' + fontClass;
            form.find('.inputIcon').val(fontClass);
            form.find('.btnShowIcon i').attr('class', fontClass);
        };
        lrEle.formSubmitEven(form, {
            url: saveUrl,
            successKey: 'code',
            successVal: '1',
            successFunc: function (e) {
                lrBox.hideNewBox();
                lrBox.msgTisf(e.msg);
                if(window.setEditRuleCallBack) {
                    window.setEditRuleCallBack();
                }
            },
            errFunc: function (e) {
                lrBox.msg(e.msg);
            },
        });
    });

</script>